notes:
  goal:
    - to ues call to achieve the goal of task composition
  why:
    - it is like dep but allow pre and post task using call

vars:
  extra_task_name: post_task

tasks:
  -
    name: pre_task
    desc: this is pre-task
    task:
      -
        func: shell
        do:
          - echo "hello"

  -
    name: post_task
    desc: this is post-task
    task:
      -
        func: shell
        desc: do step1 in shell func
        do:
          - echo "world"

  -
    name: 2ndtask
    task:
      -
        func: shell
        desc: to test multiple refs
        do:
          - echo "this is 2nd task"

  -
    name: task
    desc: this is the task and expect the final message (hello I love this world)
    task:
      -
        func: call
        do: pre_task
      -
        func: shell
        do:
          - echo " I love this "
      -
        func: call
        desc: use a dynamic var to refer to a task name
        do:
          - '{{.extra_task_name}}'
          - 2ndtask

      -
        func: call
        do:
          - pre_task: pre
            name: yes
