goal:
  - add featuer to template cmd to support sub element
  - path format is like a.b.c(name=fr*).value
  - prefix will be used to get the obj from cache, the rest will be used as yq path

vars:
  school_details_object:
    school:
      name: "sydney grammar"
      address: "1 fox road, sydney, nsw 2000"
    principals:
      - "peter"
      - "tom"
      - "jane"
    ranking: "No 5"
  root:
    parent:
      school_details_object:
        school:
          name: "sydney grammar"
          address: "1 fox road, sydney, nsw 2000"
        principals:
          - "peter"
          - "tom"
          - "jane"
        ranking: "No 5"

tasks:
  -
    name: task
    task:
      -
        func: cmd
        do:
          - name: template
            desc: render the template file using above dynamic variable from defined var
            cmd:
              src: './tests/functests/d0079.template'
              dest: /tmp/myschool.txt
              datakey: "school_details_object"

      - func: cmd
        do:
          - name: readfile
            desc: read content of a file and register it to a var
            cmd:
              filename: myschool.txt
              dir: /tmp
              reg: my_school

          -
            name: print
            cmd: "{{.my_school}}"

      -
        func: cmd
        do:
          - name: template
            desc: render the template file using above dynamic variable from defined var
            cmd:
              src: './tests/functests/d0079.template'
              dest: /tmp/myschool.txt
              datapath: "root.parent.school_details_object"

      - func: cmd
        do:
          - name: readfile
            desc: read content of a file and register it to a var
            cmd:
              filename: myschool.txt
              dir: /tmp
              reg: my_school

          -
            name: print
            cmd: "{{.my_school}}"
