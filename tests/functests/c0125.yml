notes:
  goal:
    - add feature to add a internal runtime var up_runtime_layer_number
    - it is useful for client to decide to quit or customise controll flow

tasks:

  - name: task
    task:

      - func: call
        do:
          - layer2

  - name: layer2
    task:
      - func: cmd
        do:
          -
            name: print
            cmd: 'UP_RUNTIME_LAYER_NUMBER: {{.up_runtime_layer_number}}'

      - func: call
        do:
          - layer3

  - name: layer3
    task:
      - func: cmd
        do:
          -
            name: exit
        if: '{{eq  .up_runtime_layer_number 4}}'

      - func: call
        do:
          - layer2
